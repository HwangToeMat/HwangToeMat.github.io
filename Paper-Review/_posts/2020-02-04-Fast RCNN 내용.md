---
title: 2. Fast R-CNN 논문 리뷰
image: https://github.com/HwangToeMat/HwangToeMat.github.io/blob/master/Paper-Review/image/FastRCNN/img0.jpg?raw=true
description: >
 Fast R-CNN - Fast R-CNN을 읽고 논문 주요내용을 정리해본다.
author: author1
layout: post
order: 9
---
# [Object Detection] 2. Fast R-CNN 논문 리뷰

<a href="https://arxiv.org/abs/1504.08083">[PDF] 논문원본</a>

# Fast R-CNN

## 모델 구조

<img src="https://github.com/HwangToeMat/HwangToeMat.github.io/blob/master/Paper-Review/image/FastRCNN/img1.png?raw=true" style="max-width:100%;margin-left: auto; margin-right: auto; display: block;">

Fast R-CNN은 앞서 설명한 R-CNN의 치명적인 단점을 해결하여 성능을 개선한 모델이다. 모델의 전반적인 구조는 위와 같다.

### 1단계. Selective Search

먼저 이미지에 대해 후보 영역(region proposal)을 약 2000개정도 생성한다. 여기까지는 R-CNN과 동일하지만 다른점은 생성된 후보영역의 이미지를 잘라서 하나하나 메모리에 홀딩하는것이 찾아낸 후보영역의 좌표값만 메모리에 홀딩하기 때문에 R-CNN과 다르게 높은 메모리가 필요하지는 않다.

### 2단계. Feature Extraction(CNN & ROI Projection)

모델의 input size에 맞도록 wrapping 된 이미지를 CNN모델에 넣어 이미지의 특징값을 추출(feature extract)한다. CNN 모델은 AlexNet을 변형한 구조이다.

### 3단계. ROI Pooling

* SVM을 사용하여 classification

CNN에서 얻은 feature를 SVM을 통해 분류한다.

* Bounding box regression

<img src="https://github.com/HwangToeMat/HwangToeMat.github.io/blob/master/Paper-Review/image/RCNN/img4.jpg?raw=true" style="max-width:100%;margin-left: auto; margin-right: auto; display: block;">

앞서 설정된 bounding box의 위치나 크기를 더욱 정확하게 설정하기 위해 위와같은 값으로 regression을 통해 학습한다.<br>
> P = 만들어진 bounding box<br>
> G = ground truth<br>
> x, y = box의 중심좌표<br>
> w, h = box의 너비와 높이<br>

### 4단계. Classification & Bounding Box Regression

## 기존의 방법과 비교

<img src="https://github.com/HwangToeMat/HwangToeMat.github.io/blob/master/Paper-Review/image/RCNN/img5.jpg?raw=true" style="max-width:100%;margin-left: auto; margin-right: auto; display: block;">

위의 차트와 그래프에서 보면 알 수 있듯이 여러 데이터셋에서 기존의 모델보다 월등한 성능(mAP)을 기록하는 것을 볼 수 있다.
> ps. 사실 이 모델은 3가지 단계로 이루어져 있고 처음 selective search에서 생성한 많은 이미지들을 전부 메모리에 할당하고 CNN을 돌려야하기 때문에 굉장히 무겁고 실행속도가 느리다. 따라서 이후에 이러한 단점을 보완한 Fast RCNN, Faster RCNN과 같은 모델이 나오게 된다.

## Loss Function

## Result

<img src="https://github.com/HwangToeMat/HwangToeMat.github.io/blob/master/Paper-Review/image/RCNN/img6.jpg?raw=true" style="max-width:100%;margin-left: auto; margin-right: auto; display: block;">
